# HamHome å…¨çƒåŒ–è¯­è¨€ï¼ˆi18nï¼‰å®ç°æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•
1. [æ–¹æ¡ˆæ¦‚è¿°](#æ–¹æ¡ˆæ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
4. [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)
5. [é›†æˆæŒ‡å—](#é›†æˆæŒ‡å—)
6. [ç¿»è¯‘ç®¡ç†](#ç¿»è¯‘ç®¡ç†)
7. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## æ–¹æ¡ˆæ¦‚è¿°

### æ ¸å¿ƒç›®æ ‡
- æ”¯æŒå¤šç§è¯­è¨€ï¼ˆåˆæœŸï¼šä¸­æ–‡ã€è‹±æ–‡ï¼›åæœŸï¼šæ—¥æ–‡ã€éŸ©æ–‡ç­‰ï¼‰
- ä»£ç ä¸­é›¶ç¡¬ç¼–ç ä¸­æ–‡æ–‡æœ¬
- ç»Ÿä¸€çš„ç¿»è¯‘ç®¡ç†ç³»ç»Ÿ
- æ”¯æŒæµè§ˆå™¨æ’ä»¶å’Œ Web åº”ç”¨
- æ˜“äºç»´æŠ¤å’Œæ‰©å±•

### æ”¯æŒèŒƒå›´
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      HamHome å…¨çƒåŒ–è¦†ç›–         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æµè§ˆå™¨æ’ä»¶ (Extension)         â”‚
â”‚  - ä¸»åº”ç”¨ç•Œé¢                   â”‚
â”‚  - å¼¹çª—é¢æ¿                     â”‚
â”‚  - é€‰é¡¹é¡µé¢                     â”‚
â”‚                                 â”‚
â”‚ Web åº”ç”¨                        â”‚
â”‚  - ç®¡ç†åå°                     â”‚
â”‚  - è®¾ç½®é¡µé¢                     â”‚
â”‚                                 â”‚
â”‚ ç³»ç»Ÿæ–‡æ¡ˆ                        â”‚
â”‚  - æŒ‰é’®æ–‡æ¡ˆ                     â”‚
â”‚  - æç¤ºæ–‡æ¡ˆ                     â”‚
â”‚  - é”™è¯¯ä¿¡æ¯                     â”‚
â”‚  - éªŒè¯æç¤º                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€æœ¯æ¶æ„

### é€‰å‹æ–¹æ¡ˆï¼ši18next + React

**ä¸ºä»€ä¹ˆé€‰æ‹© i18nextï¼Ÿ**
- âœ… æˆç†Ÿç¨³å®šçš„å›½é™…åŒ–è§£å†³æ–¹æ¡ˆ
- âœ… æ”¯æŒå‘½åç©ºé—´åˆ†å‰²ï¼ˆä¾¿äºå¤šåŒ…ç®¡ç†ï¼‰
- âœ… æä¾› React é›†æˆï¼ˆreact-i18nextï¼‰
- âœ… æ”¯æŒåŠ¨æ€åŠ è½½å’Œå»¶è¿ŸåŠ è½½
- âœ… æ”¯æŒå¤æ•°å½¢å¼ã€æ—¥æœŸæ ¼å¼åŒ–ç­‰
- âœ… æ´»è·ƒçš„ç¤¾åŒºç”Ÿæ€
- âœ… ä½å­¦ä¹ æˆæœ¬

### ä¾èµ–åŒ…
```json
{
  "dependencies": {
    "i18next": "^24.0.0",
    "react-i18next": "^15.0.0"
  },
  "devDependencies": {
    "i18next-scanner": "^4.4.0"
  }
}
```

### æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     React Components               â”‚
â”‚   (ä½¿ç”¨ useTranslation hook)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      react-i18next Provider         â”‚
â”‚      (I18nextProvider)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        i18next Instance             â”‚
â”‚  - åˆå§‹åŒ–é…ç½®                       â”‚
â”‚  - è¯­è¨€æ£€æµ‹                         â”‚
â”‚  - èµ„æºåŠ è½½                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Translation Resources          â”‚
â”‚  locales/                           â”‚
â”‚  â”œâ”€â”€ zh/                            â”‚
â”‚  â”‚   â”œâ”€â”€ common.json                â”‚
â”‚  â”‚   â”œâ”€â”€ bookmark.json              â”‚
â”‚  â”‚   â””â”€â”€ settings.json              â”‚
â”‚  â””â”€â”€ en/                            â”‚
â”‚      â”œâ”€â”€ common.json                â”‚
â”‚      â”œâ”€â”€ bookmark.json              â”‚
â”‚      â””â”€â”€ settings.json              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®ç°ç»†èŠ‚

### 1. æ–‡ä»¶ç»“æ„

```
/Users/yingbin/work/github/ham_home/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ extension/
â”‚   â”‚   â”œâ”€â”€ locales/                    # ç¿»è¯‘æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ en/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ common.json         # é€šç”¨æ–‡æ¡ˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ bookmark.json       # ä¹¦ç­¾ç›¸å…³
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ settings.json       # è®¾ç½®ç›¸å…³
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ai.json             # AI ç›¸å…³
â”‚   â”‚   â”‚   â””â”€â”€ zh/
â”‚   â”‚   â”‚       â”œâ”€â”€ common.json
â”‚   â”‚   â”‚       â”œâ”€â”€ bookmark.json
â”‚   â”‚   â”‚       â”œâ”€â”€ settings.json
â”‚   â”‚   â”‚       â””â”€â”€ ai.json
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ i18n/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ config.ts           # i18next é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ init.ts             # åˆå§‹åŒ–é€»è¾‘
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ types.ts            # ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useTranslation.ts       # è‡ªå®šä¹‰ç¿»è¯‘ hook
â”‚   â”‚   â”‚   â””â”€â”€ useLanguage.ts          # è¯­è¨€åˆ‡æ¢ hook
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ web/
â”‚       â”œâ”€â”€ locales/
â”‚       â”‚   â”œâ”€â”€ en/
â”‚       â”‚   â”‚   â”œâ”€â”€ common.json
â”‚       â”‚   â”‚   â”œâ”€â”€ bookmark.json
â”‚       â”‚   â”‚   â””â”€â”€ ...
â”‚       â”‚   â””â”€â”€ zh/
â”‚       â”‚       â”œâ”€â”€ common.json
â”‚       â”‚       â””â”€â”€ ...
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â””â”€â”€ i18n/
â”‚       â”‚       â”œâ”€â”€ config.ts
â”‚       â”‚       â””â”€â”€ init.ts
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ i18n/                            # å…±äº« i18n é…ç½®åŒ…
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ index.ts
â”‚       â”‚   â”œâ”€â”€ config.ts
â”‚       â”‚   â”œâ”€â”€ types.ts
â”‚       â”‚   â””â”€â”€ utils.ts
â”‚       â””â”€â”€ package.json
â”‚
â””â”€â”€ docs/
    â””â”€â”€ i18n_implementation_plan.md     # æœ¬æ–‡æ¡£
```

### 2. ç¿»è¯‘æ–‡ä»¶ç»“æ„ï¼ˆJSONï¼‰

**å¸¸ç”¨.json** - é€šç”¨æ–‡æ¡ˆ
```json
{
  "common": {
    "loading": "Loading...",
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "close": "Close",
    "confirm": "Confirm",
    "error": "Error",
    "success": "Success",
    "warning": "Warning",
    "search": "Search",
    "empty": "No data",
    "noResults": "No results found",
    "back": "Back",
    "next": "Next"
  }
}
```

**bookmark.json** - ä¹¦ç­¾ç›¸å…³
```json
{
  "bookmark": {
    "title": "Bookmarks",
    "newBookmark": "New Bookmark",
    "addBookmark": "Add Bookmark",
    "editBookmark": "Edit Bookmark",
    "deleteBookmark": "Delete Bookmark",
    "deleteConfirm": "Are you sure you want to delete this bookmark?",
    "deleteSuccess": "Bookmark deleted successfully",
    "saveSuccess": "Bookmark saved successfully",
    "saveFailed": "Failed to save bookmark",
    "placeholders": {
      "title": "Enter bookmark title",
      "description": "Enter bookmark description",
      "url": "Enter bookmark URL"
    },
    "categories": "Categories",
    "uncategorized": "Uncategorized",
    "tags": "Tags",
    "createdAt": "Created",
    "recent": "Recent Bookmarks",
    "all": "All Bookmarks",
    "search": "Search bookmarks..."
  }
}
```

**settings.json** - è®¾ç½®ç›¸å…³
```json
{
  "settings": {
    "title": "Settings",
    "language": "Language",
    "theme": "Theme",
    "themeOptions": {
      "light": "Light",
      "dark": "Dark",
      "system": "System"
    },
    "aiSettings": "AI Settings",
    "aiProvider": "AI Provider",
    "apiKey": "API Key",
    "modelName": "Model Name",
    "importBookmarks": "Import Bookmarks",
    "exportBookmarks": "Export Bookmarks",
    "about": "About"
  }
}
```

**ai.json** - AI ç›¸å…³æ–‡æ¡ˆ
```json
{
  "ai": {
    "analyzing": "AI is analyzing...",
    "generatingTitle": "Generating title...",
    "generatingDescription": "Generating description...",
    "extractingContent": "Extracting content...",
    "suggestedCategory": "Suggested Category",
    "suggestedTags": "Suggested Tags",
    "aiNotEnabled": "AI features are not enabled. Please configure AI settings.",
    "error": {
      "configNotFound": "AI configuration not found",
      "apiKeyInvalid": "Invalid API key",
      "requestFailed": "AI request failed: {{error}}"
    }
  }
}
```

### 3. i18next é…ç½®æ–‡ä»¶

**`apps/extension/lib/i18n/config.ts`**
```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// å¯¼å…¥ç¿»è¯‘èµ„æº
import enCommon from '@/locales/en/common.json';
import enBookmark from '@/locales/en/bookmark.json';
import enSettings from '@/locales/en/settings.json';
import enAi from '@/locales/en/ai.json';

import zhCommon from '@/locales/zh/common.json';
import zhBookmark from '@/locales/zh/bookmark.json';
import zhSettings from '@/locales/zh/settings.json';
import zhAi from '@/locales/zh/ai.json';

const resources = {
  en: {
    common: enCommon,
    bookmark: enBookmark,
    settings: enSettings,
    ai: enAi,
  },
  zh: {
    common: zhCommon,
    bookmark: zhBookmark,
    settings: zhSettings,
    ai: zhAi,
  },
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources,
    fallbackLng: 'en',
    debug: process.env.NODE_ENV === 'development',
    ns: ['common', 'bookmark', 'settings', 'ai'],
    defaultNS: 'common',
    interpolation: {
      escapeValue: false, // React å·²å¤„ç† XSS
    },
    detection: {
      order: [
        'localStorage', // é¦–å…ˆæ£€æŸ¥æœ¬åœ°å­˜å‚¨
        'sessionStorage',
        'cookie',
        'navigator',
        'htmlTag',
      ],
      caches: ['localStorage', 'sessionStorage', 'cookie'],
    },
  });

export default i18n;
```

**`apps/extension/lib/i18n/init.ts`**
```typescript
import i18n from './config';
import type { Language } from '@/types';

/**
 * åˆå§‹åŒ– i18n
 */
export async function initI18n(): Promise<void> {
  await i18n.init?.({ lng: 'en', fallbackLng: 'en' });
}

/**
 * è·å–å½“å‰è¯­è¨€
 */
export function getCurrentLanguage(): Language {
  return (i18n.language as Language) || 'en';
}

/**
 * æ”¹å˜è¯­è¨€
 */
export async function changeLanguage(lng: Language): Promise<string> {
  return i18n.changeLanguage(lng);
}

/**
 * è·å–ç¿»è¯‘å‡½æ•°
 */
export function getI18n() {
  return i18n;
}
```

### 4. è‡ªå®šä¹‰ Hooks

**`apps/extension/hooks/useLanguage.ts`**
```typescript
import { useEffect, useState } from 'react';
import { useTranslation } from 'react-i18next';
import { useBookmarks } from '@/contexts/BookmarkContext';
import type { Language } from '@/types';

/**
 * è¯­è¨€ç®¡ç† Hook
 */
export function useLanguage() {
  const { i18n } = useTranslation();
  const { appSettings, updateAppSettings } = useBookmarks();
  const [language, setLanguage] = useState<Language>(
    appSettings.language || 'en'
  );

  // åˆå§‹åŒ–è¯­è¨€
  useEffect(() => {
    if (language && language !== i18n.language) {
      i18n.changeLanguage(language);
    }
  }, []);

  // åˆ‡æ¢è¯­è¨€
  const switchLanguage = async (lng: Language) => {
    setLanguage(lng);
    await i18n.changeLanguage(lng);
    await updateAppSettings({ language: lng });
  };

  return {
    language,
    switchLanguage,
    availableLanguages: ['en', 'zh'] as const,
  };
}
```

**`apps/extension/hooks/useTranslation.ts`** (å¯é€‰ï¼Œå°è£…ç¿»è¯‘)
```typescript
import { useTranslation as useI18nTranslation } from 'react-i18next';

export function useTranslation(namespace?: string) {
  return useI18nTranslation(namespace);
}
```

### 5. åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨

**åŸºç¡€ç”¨æ³•**
```typescript
import { useTranslation } from 'react-i18next';

export function BookmarkCard() {
  const { t } = useTranslation('bookmark');

  return (
    <div>
      <h3>{t('bookmark.title')}</h3>
      <button>{t('bookmark.newBookmark')}</button>
    </div>
  );
}
```

**å¸¦å‚æ•°çš„ç¿»è¯‘**
```typescript
const { t } = useTranslation('ai');

// ç¿»è¯‘æ–‡ä»¶ä¸­ï¼š
// "requestFailed": "AI request failed: {{error}}"

return (
  <div>{t('ai.error.requestFailed', { error: 'Network timeout' })}</div>
);
```

**å¤æ•°å½¢å¼**
```typescript
const { t } = useTranslation('bookmark');

// ç¿»è¯‘æ–‡ä»¶ä¸­ï¼š
// "count": "You have {{count}} bookmark",
// "count_plural": "You have {{count}} bookmarks"

return <div>{t('bookmark.count', { count: 5 })}</div>;
```

### 6. æä¾›è€…è®¾ç½®

**`apps/extension/entrypoints/app/main.tsx`**
```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import { I18nextProvider } from 'react-i18next';
import i18n from '@/lib/i18n/config';
import { App } from './App';

// åˆå§‹åŒ– i18n
void i18n.init();

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <I18nextProvider i18n={i18n}>
      <App />
    </I18nextProvider>
  </React.StrictMode>
);
```

---

## é›†æˆæŒ‡å—

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
# åœ¨ extension é¡¹ç›®ä¸­
cd apps/extension
pnpm add i18next react-i18next i18next-browser-languagedetector
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç¿»è¯‘æ–‡ä»¶

åˆ›å»ºç›®å½•ç»“æ„ï¼š
```
apps/extension/locales/
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ bookmark.json
â”‚   â”œâ”€â”€ settings.json
â”‚   â””â”€â”€ ai.json
â””â”€â”€ zh/
    â”œâ”€â”€ common.json
    â”œâ”€â”€ bookmark.json
    â”œâ”€â”€ settings.json
    â””â”€â”€ ai.json
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½® i18next

å°† `config.ts` å’Œ `init.ts` æ”¾å…¥ `apps/extension/lib/i18n/`

### ç¬¬å››æ­¥ï¼šæ›´æ–°ä¸»å…¥å£

ä¿®æ”¹ `apps/extension/entrypoints/app/main.tsx`ï¼Œæ·»åŠ  `I18nextProvider`

### ç¬¬äº”æ­¥ï¼šé€æ­¥é‡æ„ç»„ä»¶

åœ¨æ¯ä¸ªç»„ä»¶ä¸­ï¼š
1. å¯¼å…¥ `useTranslation` hook
2. å°†ç¡¬ç¼–ç çš„ä¸­æ–‡æ–‡æ¡ˆæ›¿æ¢ä¸º `t()` å‡½æ•°è°ƒç”¨
3. ç¡®ä¿æ‰€æœ‰æ–‡æ¡ˆéƒ½æœ‰å¯¹åº”çš„ç¿»è¯‘

### ç¬¬å…­æ­¥ï¼šè®¾ç½®é¡µé¢é›†æˆ

åœ¨è®¾ç½®é¡µé¢æ·»åŠ è¯­è¨€é€‰é¡¹ï¼š
```typescript
import { useLanguage } from '@/hooks/useLanguage';

export function SettingsPage() {
  const { t } = useTranslation('settings');
  const { language, switchLanguage, availableLanguages } = useLanguage();

  return (
    <div>
      <label>{t('settings.language')}</label>
      <select value={language} onChange={(e) => switchLanguage(e.target.value)}>
        {availableLanguages.map((lng) => (
          <option key={lng} value={lng}>
            {t(`settings.languages.${lng}`)}
          </option>
        ))}
      </select>
    </div>
  );
}
```

---

## ç¿»è¯‘ç®¡ç†

### 1. ç¿»è¯‘å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¼€å‘äººå‘˜                            â”‚
â”‚ (ä½¿ç”¨ useTranslation ç¼–å†™ä»£ç )      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ i18next-scanner æ‰«æ               â”‚
â”‚ (è‡ªåŠ¨æå–å¾…ç¿»è¯‘å­—ç¬¦ä¸²)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¿»è¯‘äººå‘˜                            â”‚
â”‚ (ç¼–è¾‘ JSON ç¿»è¯‘æ–‡ä»¶)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QA å®¡æŸ¥                             â”‚
â”‚ (æ£€æŸ¥ç¿»è¯‘è´¨é‡)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘å¸ƒ                                â”‚
â”‚ (æäº¤ä»£ç )                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. i18next-scanner é…ç½®

åˆ›å»º `i18next-scanner.config.js`ï¼š
```javascript
module.exports = {
  input: [
    'apps/extension/**/*.{js,jsx,ts,tsx}',
    'apps/web/**/*.{js,jsx,ts,tsx}',
  ],
  output: './',
  options: {
    debug: false,
    func: {
      list: ['i18next.t', 't', 'useTranslation'],
      extensions: ['.js', '.jsx', '.ts', '.tsx'],
    },
    lng: ['en', 'zh'],
    ns: ['common', 'bookmark', 'settings', 'ai'],
    defaultLng: 'en',
    defaultNS: 'common',
    resource: {
      loadPath: 'apps/{{appName}}/locales/{{lng}}/{{ns}}.json',
      savePath: 'apps/{{appName}}/locales/{{lng}}/{{ns}}.json',
      jsonIndent: 2,
      lineSeperator: '\n',
    },
  },
};
```

### 3. ç¿»è¯‘æµç¨‹å»ºè®®

1. **æ ‡è®°å…³é”®æ–‡æ¡ˆ**
   - ä½¿ç”¨ `t('namespace.key')` å‡½æ•°åŒ…è£…æ‰€æœ‰ç”¨æˆ·å¯è§çš„æ–‡æœ¬
   - ä¿æŒä¸€è‡´çš„å‘½åè§„èŒƒ

2. **å®šæœŸåŒæ­¥ç¿»è¯‘**
   ```bash
   # è¿è¡Œæ‰«æå·¥å…·ï¼Œç”Ÿæˆç¿»è¯‘æ¨¡æ¿
   npx i18next-scanner
   ```

3. **ç‰ˆæœ¬æ§åˆ¶ç¿»è¯‘æ–‡ä»¶**
   - ç¿»è¯‘æ–‡ä»¶ä¿å­˜åœ¨ Git
   - æ¯æ¬¡å‘å¸ƒå‰å®¡æŸ¥ç¿»è¯‘æ›´æ–°

4. **ç¤¾åŒºè´¡çŒ®ç¿»è¯‘**
   - åœ¨ GitHub ä¸Šåˆ›å»ºç¿»è¯‘ issue
   - æ¥å—ç¤¾åŒº PR æäº¤ç¿»è¯‘

---

## æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ

```json
{
  "common": {
    "actions": {
      "save": "Save",
      "cancel": "Cancel"
    },
    "messages": {
      "loading": "Loading...",
      "error": "An error occurred"
    },
    "placeholders": {
      "search": "Search...",
      "enterName": "Enter your name"
    }
  }
}
```

**è§„åˆ™**
- æŒ‰åŠŸèƒ½æ¨¡å—åˆ†å±‚
- ä½¿ç”¨å°é©¼å³°å‘½å
- é¿å…è¿‡åº¦åµŒå¥—ï¼ˆæœ€å¤š 3-4 å±‚ï¼‰

### 2. å‚æ•°åŒ–ç¿»è¯‘

```typescript
// âŒ é”™è¯¯
t('bookmarkDeletedAt') // "å·²åˆ é™¤çš„ä¹¦ç­¾: xxx"

// âœ… æ­£ç¡®
t('bookmark.deletedAt', { title: 'My Bookmark' })
// ç¿»è¯‘æ–‡ä»¶: "deletedAt": "Deleted bookmark: {{title}}"
```

### 3. å¸¸è§æ–‡æ¡ˆå…±ç”¨

```typescript
// âŒ é¿å…é‡å¤
"common.save": "Save",
"bookmark.save": "Save",
"settings.save": "Save"

// âœ… ä½¿ç”¨å…±ç”¨æ–‡æ¡ˆ
// common.json ä¸­å®šä¹‰ä¸€æ¬¡
"common.save": "Save"
```

### 4. æ—¥æœŸå’Œæ•°å­—æ ¼å¼

```typescript
import { useTranslation } from 'react-i18next';

export function DateDisplay({ timestamp }) {
  const { i18n } = useTranslation();
  
  const date = new Date(timestamp);
  const formatted = new Intl.DateTimeFormat(i18n.language, {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date);
  
  return <span>{formatted}</span>;
}
```

### 5. å¤„ç†HTMLå†…å®¹

```typescript
// ç¿»è¯‘æ–‡ä»¶
"welcome": "Welcome, <1>{{name}}</1>"

// ç»„ä»¶ä¸­
const { t } = useTranslation();
return <Trans i18nKey="welcome" values={{ name: 'John' }}>
  Welcome, <strong></strong>
</Trans>;
```

### 6. ç±»å‹å®‰å…¨

**`apps/extension/lib/i18n/types.ts`**
```typescript
// ç¡®ä¿ç¿»è¯‘é”®çš„ç±»å‹å®‰å…¨
export type TranslationKey = 
  | 'common.save'
  | 'common.cancel'
  | 'bookmark.title'
  | 'bookmark.newBookmark'
  // ... æ›´å¤šé”®

export interface TranslationNamespace {
  common: typeof import('@/locales/en/common.json');
  bookmark: typeof import('@/locales/en/bookmark.json');
  settings: typeof import('@/locales/en/settings.json');
  ai: typeof import('@/locales/en/ai.json');
}
```

### 7. æ€§èƒ½ä¼˜åŒ–

```typescript
// ä½¿ç”¨å‘½åç©ºé—´åˆ†å‰²ï¼Œå‡å°‘åŠ è½½ä½“ç§¯
const { t } = useTranslation(['common', 'bookmark']);

// æ‡’åŠ è½½ä¸å¸¸ç”¨çš„å‘½åç©ºé—´
const { t: t_settings } = useTranslation('settings');
```

### 8. é”™è¯¯å¤„ç†

```typescript
function useTranslationWithFallback(key: string, defaultValue: string) {
  const { t } = useTranslation();
  
  try {
    const translated = t(key);
    return translated === key ? defaultValue : translated;
  } catch {
    return defaultValue;
  }
}
```

---

## åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

### é˜¶æ®µ 1ï¼šåŸºç¡€è®¾ç½®ï¼ˆç¬¬ 1 å‘¨ï¼‰
- [ ] å®‰è£…ä¾èµ–
- [ ] åˆ›å»ºç¿»è¯‘æ–‡ä»¶ç»“æ„
- [ ] é…ç½® i18next
- [ ] åœ¨ä¸»å…¥å£æ·»åŠ  Provider
- [ ] åˆ›å»º useLanguage Hook

### é˜¶æ®µ 2ï¼šæ ¸å¿ƒæ¨¡å—ç¿»è¯‘ï¼ˆç¬¬ 2-3 å‘¨ï¼‰
- [ ] ç¿»è¯‘ common.jsonï¼ˆå…±ç”¨æ–‡æ¡ˆï¼‰
- [ ] ç¿»è¯‘ bookmark.jsonï¼ˆä¹¦ç­¾æ¨¡å—ï¼‰
- [ ] æ›´æ–° BookmarkList ç»„ä»¶
- [ ] æ›´æ–° MainContent ç»„ä»¶
- [ ] æ›´æ–° Sidebar ç»„ä»¶

### é˜¶æ®µ 3ï¼šè®¾ç½®å’Œé…ç½®ç¿»è¯‘ï¼ˆç¬¬ 4 å‘¨ï¼‰
- [ ] ç¿»è¯‘ settings.json
- [ ] ç¿»è¯‘ ai.json
- [ ] æ›´æ–° OptionsPage ç»„ä»¶
- [ ] æ·»åŠ è¯­è¨€åˆ‡æ¢UI
- [ ] é›†æˆåˆ° LocalSettings

### é˜¶æ®µ 4ï¼šWeb åº”ç”¨ç¿»è¯‘ï¼ˆç¬¬ 5-6 å‘¨ï¼‰
- [ ] å¤åˆ¶ i18n é…ç½®åˆ° web åº”ç”¨
- [ ] ç¿»è¯‘ web åº”ç”¨çš„æ‰€æœ‰é¡µé¢
- [ ] æµ‹è¯•å¤šè¯­è¨€åˆ‡æ¢

### é˜¶æ®µ 5ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆç¬¬ 7 å‘¨ï¼‰
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] ç¿»è¯‘è´¨é‡å®¡æŸ¥
- [ ] ç”¨æˆ·ç•Œé¢æµ‹è¯•

### é˜¶æ®µ 6ï¼šå‘å¸ƒå’Œç»´æŠ¤ï¼ˆç¬¬ 8 å‘¨ï¼‰
- [ ] å‘å¸ƒæ–°ç‰ˆæœ¬
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] æŒç»­æ”¹è¿›ç¿»è¯‘

---

## æŠ€æœ¯æ ˆæ€»ç»“

| åŠŸèƒ½ | åº“ | ç‰ˆæœ¬ |
|------|-----|------|
| å›½é™…åŒ–æ ¸å¿ƒ | i18next | ^24.0.0 |
| React é›†æˆ | react-i18next | ^15.0.0 |
| è¯­è¨€æ£€æµ‹ | i18next-browser-languagedetector | ^7.0.0 |
| ç¿»è¯‘æ‰«æ | i18next-scanner | ^4.4.0 |

---

## å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

### Q: å¦‚ä½•å¤„ç†æ—¥æœŸæ ¼å¼åŒ–ï¼Ÿ
**A:** ä½¿ç”¨ `Intl.DateTimeFormat` APIï¼Œæ ¹æ®å½“å‰è¯­è¨€è‡ªåŠ¨æ ¼å¼åŒ–ã€‚

```typescript
new Intl.DateTimeFormat(i18n.language).format(new Date())
```

### Q: å¦‚ä½•å¤„ç†å¤æ•°å½¢å¼ï¼Ÿ
**A:** i18next å†…ç½®æ”¯æŒï¼Œåœ¨ç¿»è¯‘æ–‡ä»¶ä¸­ä½¿ç”¨ `_plural` åç¼€ã€‚

```json
{
  "item": "You have {{count}} item",
  "item_plural": "You have {{count}} items"
}
```

### Q: å¦‚ä½•æ·»åŠ æ–°è¯­è¨€ï¼Ÿ
**A:** 
1. åˆ›å»ºæ–°çš„è¯­è¨€ç›®å½• `locales/ja/`
2. å¤åˆ¶æ‰€æœ‰ JSON æ–‡ä»¶å¹¶ç¿»è¯‘
3. æ›´æ–° i18next é…ç½®ä¸­çš„ `resources`
4. åœ¨è¯­è¨€åˆ‡æ¢ UI ä¸­æ·»åŠ æ–°è¯­è¨€é€‰é¡¹

### Q: ç¿»è¯‘æ–‡ä»¶å¯ä»¥æ”¯æŒ JavaScript å‡½æ•°å—ï¼Ÿ
**A:** ä¸æ¨èã€‚ä¿æŒ JSON æ ¼å¼çº¯æ–‡æœ¬ï¼Œéœ€è¦é€»è¾‘æ—¶ä½¿ç”¨å‚æ•°åŒ–ã€‚

### Q: å¦‚ä½•å¤„ç†æœªç¿»è¯‘çš„é”®ï¼Ÿ
**A:** è®¾ç½® `fallbackLng` å’Œ `saveMissing` é€‰é¡¹ï¼Œi18next ä¼šè‡ªåŠ¨è®°å½•ç¼ºå¤±çš„ç¿»è¯‘ã€‚

---

## å‚è€ƒé“¾æ¥

- [i18next å®˜æ–¹æ–‡æ¡£](https://www.i18next.com/)
- [react-i18next æ–‡æ¡£](https://react.i18next.com/)
- [i18next-scanner æ–‡æ¡£](https://github.com/i18next/i18next-scanner)
- [å›½é™…åŒ–æœ€ä½³å®è·µ](https://www.w3.org/International/)

---

## ç›¸å…³æ–‡æ¡£

- [å¼€å‘è€…æŒ‡å—](./tech_browser_extension.md)
- [é¡¹ç›®æ¶æ„](./tech_shared_modules.md)
- [äº§å“è§„åˆ’](./prd.md)

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´ |
|------|------|------|
| 1.0 | 2026-01-10 | åˆç‰ˆæ–¹æ¡ˆ |

---

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æ”¹è¿›è¿™ä¸ªæ–¹æ¡ˆï¼è¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è´¡çŒ®ï¼š

1. æäº¤ Issue è®¨è®ºæ”¹è¿›å»ºè®®
2. æäº¤ PR æ”¹è¿›æ–‡æ¡£
3. å‚ä¸ç¿»è¯‘å·¥ä½œ

---

**æ–‡æ¡£ç»´æŠ¤è€…**: HamHome å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2026-01-10
